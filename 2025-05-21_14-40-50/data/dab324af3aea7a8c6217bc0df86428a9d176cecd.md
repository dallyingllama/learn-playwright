# Test info

- Name: ✅ Broken Links - Images >> 🔗 should detect broken and valid links by status code
- Location: /home/runner/work/learn-playwright/learn-playwright/tests/brokenLinksImages.spec.ts:30:7

# Error details

```
Error: Link "http://the-internet.herokuapp.com/status_codes/500" should return status < 400

expect(received).toBeLessThan(expected)

Expected: < 400
Received:   500
    at /home/runner/work/learn-playwright/learn-playwright/tests/brokenLinksImages.spec.ts:43:79
    at /home/runner/work/learn-playwright/learn-playwright/tests/brokenLinksImages.spec.ts:33:5
```

# Page snapshot

```yaml
- img "adplus-dvertising"
- iframe
- banner:
  - link:
    - /url: https://demoqa.com
    - img
- img
- text: Elements
- img
- list:
  - listitem:
    - img
    - text: Text Box
  - listitem:
    - img
    - text: Check Box
  - listitem:
    - img
    - text: Radio Button
  - listitem:
    - img
    - text: Web Tables
  - listitem:
    - img
    - text: Buttons
  - listitem:
    - img
    - text: Links
  - listitem:
    - img
    - text: Broken Links - Images
  - listitem:
    - img
    - text: Upload and Download
  - listitem:
    - img
    - text: Dynamic Properties
- img
- text: Forms
- img
- img
- text: Alerts, Frame & Windows
- img
- img
- text: Widgets
- img
- img
- text: Interactions
- img
- img
- text: Book Store Application
- img
- heading "Broken Links - Images" [level=1]
- paragraph: Valid image
- img
- paragraph: Broken image
- img
- paragraph: Valid Link
- link "Click Here for Valid Link":
  - /url: http://demoqa.com
- paragraph: Broken Link
- link "Click Here for Broken Link":
  - /url: http://the-internet.herokuapp.com/status_codes/500
- img "Build PlayWright tests with AI"
- iframe
- iframe
- contentinfo: © 2013-2020 TOOLSQA.COM | ALL RIGHTS RESERVED.
```

# Test source

```ts
   1 | // tests/brokenLinksImages.spec.ts
   2 | import { test, expect, request } from '@playwright/test';
   3 | import { BrokenLinksImagesPage } from '../pageObjects/BrokenLinksImagesPage';
   4 |
   5 | test.describe('✅ Broken Links - Images', () => {
   6 |   async function navigateToBrokenLinksImages(page): Promise<BrokenLinksImagesPage> {
   7 |     return await test.step('🌐 Navigate to Broken Links - Images page', async () => {
   8 |       const brokenPage = new BrokenLinksImagesPage(page);
   9 |       await brokenPage.goto();
  10 |       return brokenPage;
  11 |     });
  12 |   }
  13 |
  14 |   test('🖼️ should detect broken and valid images', async ({ page }) => {
  15 |     const brokenPage = await navigateToBrokenLinksImages(page);
  16 |
  17 |     await test.step('📸 Collect all image elements', async () => {
  18 |       const images = await page.$$('img');
  19 |       expect(images.length).toBeGreaterThan(0);
  20 |
  21 |       for (const img of images) {
  22 |         const isLoaded = await img.evaluate((imgEl: HTMLImageElement) => imgEl.naturalWidth > 0);
  23 |         const src = await img.getAttribute('src');
  24 |         console.log(`Image src="${src}" => ${isLoaded ? 'OK' : 'BROKEN'}`);
  25 |         expect(isLoaded, `Image with src="${src}" should load`).toBe(true);
  26 |       }
  27 |     });
  28 |   });
  29 |
  30 |   test('🔗 should detect broken and valid links by status code', async ({ page, request }) => {
  31 |     const brokenPage = await navigateToBrokenLinksImages(page);
  32 |
  33 |     await test.step('🔍 Collect and validate all link elements', async () => {
  34 |       const links = await page.$$('a[href]');
  35 |       expect(links.length).toBeGreaterThan(0);
  36 |
  37 |       for (const link of links) {
  38 |         const url = await link.getAttribute('href');
  39 |         if (!url || url.startsWith('javascript')) continue;
  40 |
  41 |         const response = await request.get(url);
  42 |         console.log(`Link "${url}" => ${response.status()}`);
> 43 |         expect(response.status(), `Link "${url}" should return status < 400`).toBeLessThan(400);
     |                                                                               ^ Error: Link "http://the-internet.herokuapp.com/status_codes/500" should return status < 400
  44 |       }
  45 |     });
  46 |   });
  47 | });
  48 |
```