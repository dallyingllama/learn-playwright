# Test info

- Name: Elements >> ✅ Check Box >> ✅ Drill-down and select Notes under Desktop
- Location: /home/runner/work/learn-playwright/learn-playwright/tests/checkBox.spec.ts:69:9

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toHaveText(expected)

Locator: locator('h1')
Expected string: "Check Box"
Received string: "502 Bad Gateway"
Call log:
  - expect.toHaveText with timeout 5000ms
  - waiting for locator('h1')
    9 × locator resolved to <h1>502 Bad Gateway</h1>
      - unexpected value "502 Bad Gateway"

    at CheckBoxPage.waitForPageReady (/home/runner/work/learn-playwright/learn-playwright/pageObjects/CheckBoxPage.ts:39:43)
    at AsyncFunction.viaDirectLink (/home/runner/work/learn-playwright/learn-playwright/pageObjects/CheckBoxPage.ts:33:24)
    at /home/runner/work/learn-playwright/learn-playwright/tests/checkBox.spec.ts:10:9
    at navigateToCheckBoxPage (/home/runner/work/learn-playwright/learn-playwright/tests/checkBox.spec.ts:8:14)
    at /home/runner/work/learn-playwright/learn-playwright/tests/checkBox.spec.ts:70:28
```

# Page snapshot

```yaml
- heading "502 Bad Gateway" [level=1]
- separator
- text: nginx/1.17.10 (Ubuntu)
```

# Test source

```ts
   1 | // pageObjects/CheckBoxPage.ts
   2 | import { Page, Locator, expect } from '@playwright/test';
   3 | import { BasePage } from './BasePage';
   4 | import { createGotoWithVariants } from '../utils/gotoHelper';
   5 | import { NavigablePage } from './interfaces/NavigablePage';
   6 |
   7 | const config = {
   8 |   menu: 'Elements',
   9 |   menuItem: 'Check Box',
   10 |   url: 'checkbox',
   11 |   header: 'Check Box',
   12 |   topNodeCheckboxText: 'Home',
   13 | };
   14 |
   15 | export class CheckBoxPage extends BasePage implements NavigablePage {
   16 |   readonly expandAllButton: Locator;
   17 |   readonly resultOutput: Locator;
   18 |   readonly goto;
   19 |
   20 |   constructor(page: Page) {
   21 |     super(page);
   22 |     this.expandAllButton = page.locator('button[title="Expand all"]');
   23 |     this.resultOutput = page.locator('#result');
   24 |
   25 |         this.goto = createGotoWithVariants(
   26 |           async () => {
   27 |             await this.openSidebarFromHome(config.menu);
   28 |             await this.sidebarMenu.navigateTo(config.menuItem);
   29 |             await this.waitForPageReady();
   30 |           },
   31 |           async () => {
   32 |             await this.page.goto(config.url);
   33 |             await this.waitForPageReady();
   34 |           }
   35 |         );
   36 |   }
   37 |
   38 |   override async waitForPageReady(): Promise<void> {
>  39 |     await expect(this.page.locator('h1')).toHaveText(config.header);
      |                                           ^ Error: Timed out 5000ms waiting for expect(locator).toHaveText(expected)
   40 |   }
   41 |
   42 |   async assertOnPage(): Promise<void> {
   43 |     await expect(this.page).toHaveURL(config.url);
   44 |     await expect(this.page.locator('h1')).toHaveText(config.header);
   45 |   }
   46 |
   47 |   async expandAll() {
   48 |     await this.expandAllButton.click(); // Expand all checkboxes
   49 |   }
   50 |
   51 |   async checkAll({
   52 |     expand = true,
   53 |     method = Math.random() > 0.66 ? 'viaText' : (Math.random() > 0.5 ? 'viaCheckbox' : 'viaIcon'), // Random default
   54 |   }: {
   55 |     expand?: boolean;
   56 |     method?: 'viaText' | 'viaCheckbox' | 'viaIcon';
   57 |   } = {}): Promise<void> {
   58 |     if (expand) {
   59 |       await this.expandAll();
   60 |     }
   61 |   
   62 |     switch (method) {
   63 |       case 'viaCheckbox': {
   64 |         const checkbox = this.page.locator('label').filter({ hasText: config.topNodeCheckboxText }).getByRole('img').first()
   65 |         await expect(checkbox).toBeVisible();
   66 |         await expect(checkbox).toBeEnabled();
   67 |         await checkbox.check();
   68 |         break;
   69 |       }
   70 |   
   71 |       case 'viaIcon': {
   72 |         const icon = this.page.locator('.rct-icon-parent-close, .rct-icon-parent-open')
   73 |           .first();
   74 |         await expect(icon).toBeVisible();
   75 |         await icon.click();
   76 |         break;
   77 |       }
   78 |   
   79 |       case 'viaText':
   80 |       default: {
   81 |         const label = this.page.getByText(config.topNodeCheckboxText);
   82 |         await expect(label).toBeVisible();
   83 |         await expect(label).toBeEnabled();
   84 |         await label.click();
   85 |         break;
   86 |       }
   87 |     }
   88 |     console.log('✔️ Checked boxes:', await this.getCheckedBoxCount());
   89 |   }
   90 |   
   91 |   async uncheckAll() {
   92 |     const checkbox = this.page.getByRole('checkbox', { name: config.topNodeCheckboxText });
   93 |     await checkbox.uncheck(); // Uncheck all checkboxes
   94 |   }
   95 |  
   96 |   async expand(label: string): Promise<void> {
   97 |     // 1. Locate the tree node container by its title
   98 |     const node = this.page.locator('span.rct-text', {
   99 |       has: this.page.locator('span.rct-title', { hasText: new RegExp(`^${label}$`) })
  100 |     });
  101 |     await expect(node).toBeVisible();
  102 |   
  103 |     // 2. Select the toggle button in this node
  104 |     const toggleBtn = node.locator('button[aria-label="Toggle"]');
  105 |     await expect(toggleBtn).toBeVisible();
  106 |   
  107 |     // 3. Click to toggle expansion
  108 |     await toggleBtn.click();
  109 |   
  110 |     // 4. Wait for the <ul> child inside the same <li role="treeitem">
  111 |
  112 |     const treeItem = node.locator('xpath=parent::li');
  113 |     // Wait for its class to include "rct-node-expanded"
  114 |     await expect(treeItem).toHaveClass(/.*\brct-node-expanded\b.*/, { timeout: 5000 });
  115 |   }
  116 |
  117 |   async check(
  118 |     labelText: string,
  119 |     {
  120 |       expand = true,
  121 |       method = Math.random() > 0.66 ? 'viaText' : (Math.random() > 0.5 ? 'viaCheckbox' : 'viaIcon'),
  122 |     }: {
  123 |       expand?: boolean;
  124 |       method?: 'viaText' | 'viaCheckbox' | 'viaIcon';
  125 |     } = {}
  126 |   ): Promise<void> {
  127 |     if (expand) {
  128 |       await this.expandAll(); // Optional: adjust if label-specific expansion is needed
  129 |     }
  130 |   
  131 |     switch (method) {
  132 |       case 'viaCheckbox': {
  133 |         const checkbox = this.page
  134 |           .locator('label')
  135 |           .filter({ hasText: labelText })
  136 |           .getByRole('img')
  137 |           .first();
  138 |         await expect(checkbox).toBeVisible();
  139 |         await expect(checkbox).toBeEnabled();
```